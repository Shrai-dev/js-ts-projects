const animalArray = [
	{
		id: 1,
		name: 'giant Pandas',
		img: '../../assets/images/pets-panda.png',
		location: 'Native to Southwest China',
		mealIcon: '../../assets/icons/pets-banana-bamboo_icon.svg',
	},
	{
		id: 2,
		name: 'Eagles',
		img: '../../assets/images/pets-eagle.png',
		location: 'Native to South America',
		mealIcon: '../../assets/icons/pets-meat-fish_icon.svg',
	},
	{
		id: 3,
		name: 'Gorillas',
		img: '../../assets/images/pets-gorilla.png',
		location: 'Native to Congo',
		mealIcon: '../../assets/icons/pets-banana-bamboo_icon.svg',
	},
	{
		id: 4,
		name: 'Two-toed Sloth',
		img: '../../assets/images/pets-sloth.png',
		location: 'Mesoamerica, South America',
		mealIcon: '../../assets/icons/pets-banana-bamboo_icon.svg',
	},
	{
		id: 5,
		name: 'cheetahs',
		img: '../../assets/images/pets-cheetah.png',
		location: 'Native to Africa',
		mealIcon: '../../assets/icons/pets-meat-fish_icon.svg',
	},
	{
		id: 6,
		name: 'Penguins',
		img: '../../assets/images/pets-penguin.png',
		location: 'Native to Antarctica',
		mealIcon: '../../assets/icons/pets-meat-fish_icon.svg',
	},
	{
		id: 7,
		name: 'Alligators',
		img: '../../assets/images/pets-alligator.png',
		location: 'Native to Southeastern U. S.',
		mealIcon: '../../assets/icons/pets-meat-fish_icon.svg',
	},
	{
		id: 8,
		name: 'Koalas',
		img: '../../assets/images/pets-koala.png',
		location: 'Native to Australia',
		mealIcon: '../../assets/icons/pets-banana-bamboo_icon.svg',
	},
];

const testimonialsArray = [
	{
		id: 1,
		name: 'Michael John',
		icon: '../../assets/icons/testimonials-user_icon1.svg',
		location: 'Local Austria',
		wasOnline: 'Today',
		feedback:
			"The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.<br>The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for",
	},
	{
		id: 2,
		name: 'Oskar Samborsky',
		icon: '../../assets/icons/testimonials-icon_user2.png',
		location: 'Local Austria',
		wasOnline: 'Yesterday',
		feedback:
			"Online zoo is one of the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas.<br> The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for",
	},
	{
		id: 3,
		name: 'Fredericka Michelin',
		icon: '../../assets/icons/testimonials-icon_user3.png',
		location: 'Local Austria',
		wasOnline: 'Yesterday',
		feedback:
			"The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.<br> The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for",
	},
	{
		id: 4,
		name: 'Mila Riksha',
		icon: '../../assets/icons/testimonials-icon_user4.png',
		location: 'Local Austria',
		wasOnline: 'Today',
		feedback:
			"The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.<br>The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for",
	},
	{
		id: 5,
		name: 'John Doe',
		icon: '../../assets/icons/testimonials-icon_user5.png',
		location: 'Local Austria',
		wasOnline: 'Yesterday',
		feedback:
			"The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.<br> The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas.",
	},
	{
		id: 6,
		name: 'Karen Maitland',
		icon: '../../assets/icons/testimonials-icon_user6.png',
		location: 'Local Austria',
		wasOnline: 'Yesterday',
		feedback:
			"The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.<br> The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas.",
	},
	{
		id: 7,
		name: 'Sara Jones',
		icon: '../../assets/icons/testimonials-icon_user7.png',
		location: 'Local Austria',
		wasOnline: 'Yesterday',
		feedback:
			"My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love  animals.The best online zoo I've met. My son delighted very much likes to watch gorillas.<br> The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf",
	},
	{
		id: 8,
		name: 'Alex Barden',
		icon: '../../assets/icons/testimonials-icon_user8.png',
		location: 'Local Austria',
		wasOnline: 'Yesterday',
		feedback:
			"The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.<br> The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas.",
	},
	{
		id: 9,
		name: 'Tina Smith',
		icon: '../../assets/icons/testimonials-icon_user9.png',
		location: 'Local Austria',
		wasOnline: 'Yesterday',
		feedback:
			"The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.<br> The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas.",
	},
	{
		id: 10,
		name: 'Alene Ray',
		icon: '../../assets/icons/testimonials-user_icon1.svg',
		location: 'Local Austria',
		wasOnline: 'Yesterday',
		feedback:
			"My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love  animals.The best online zoo I've met. My son delighted very much likes to watch gorillas.<br> The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf",
	},
	{
		id: 11,
		name: 'Clair Black',
		icon: '../../assets/icons/testimonials-icon_user4.png',
		location: 'Local Austria',
		wasOnline: 'Yesterday',
		feedback:
			"My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love for animals.The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf the ways to instill a love  animals.The best online zoo I've met. My son delighted very much likes to watch gorillas.<br> The best online zoo I've met. My son delighted very much likes to watch gorillas. Online zoo is one jf",
	},
];

const burgerIcon = document.querySelector('.burger__menu');
const headerLogo = document.querySelector('.logo');
const navigationMenu = document.querySelector('.navigation__list');
const navigationItems = document.querySelectorAll('.navigation__list-item');
const overlay = document.createElement('div');
overlay.classList.add('overlay');

const petsContainer = document.querySelector('.pets__cards');
const prevPetsPage = document.querySelector('.prev-btn');
const nextPetsPage = document.querySelector('.next-btn');

const testimonialsContainer = document.querySelector(
	'.testimonials__slider-inner'
);
const testimonialsRange = document.querySelector(
	'.testimonials__slider-range[type="range"'
);

function open() {
	navigationMenu.classList.remove('hide');
	navigationMenu.classList.add('show');
	headerLogo.classList.add('header__logo-burger');
	burgerIcon.classList.add('active');
	document.body.prepend(overlay);
}

function close() {
	navigationMenu.classList.remove('show');
	navigationMenu.classList.add('hide');
	headerLogo.classList.remove('header__logo-burger');
	burgerIcon.classList.remove('active');
	overlay.remove();
}

burgerIcon.addEventListener('click', () => {
	navigationMenu.classList.contains('show') ? close() : open();
});

overlay.addEventListener('click', close);

let petsData = [...animalArray];
let fullAnimalList = [];

function createPets() {
	fullAnimalList = (() => {
		let tempArr = [];

		for (let i = 0; i < 6; i++) {
			const newPets = petsData;

			for (let j = newPets.length; j > 0; j--) {
				let randInd = Math.floor(Math.random() * j);
				const randElem = petsData.splice(randInd, 1)[0];
				newPets.push(randElem);
			}

			tempArr = [...tempArr, ...newPets];
		}
		return tempArr;
	})();
	fullAnimalList = sortPetsList(fullAnimalList);

	createPetsCards(fullAnimalList);
}
createPets();

function createPetsCards(list) {
	petsContainer.innerHTML += createElements(list);
}

function createElements(petsList) {
	let str = '';
	for (let i = 0; i < petsList.length; i++) {
		str += `
		        <div class="pets__card" data-id="${petsList[i].id}">
		          <div class="image__wrapper">
		          	<img class="pets__card-image" src="${petsList[i].img}" alt="${petsList[i].name}">
		          </div>
		          <div class="pets__card-content">
		          	<h5 class="pets__card-title">
		          	${petsList[i].name}
		          	</h5>
		          	<p class="pets__card-desc">
		          	${petsList[i].location}
		          	</p>
		          	<img class="pets__card-icon banana-icon" src="${petsList[i].mealIcon}" alt="">
		          </div>
		        </div>
						`;
	}

	return str;
}

function sortPetsList(list) {
	let unique8List = [];
	let length = list.length;
	for (let i = 0; i < length / 8; i++) {
		const uniqueStepList = [];
		for (j = 0; j < list.length; j++) {
			if (uniqueStepList.length >= 8) {
				break;
			}
			const isUnique = !uniqueStepList.some((item) => {
				return item.name === list[j].name;
			});
			if (isUnique) {
				uniqueStepList.push(list[j]);
				list.splice(j, 1);
				j--;
			}
		}
		unique8List = [...unique8List, ...uniqueStepList];
	}
	list = unique8List;
	list = sortRecursivelyPetsList(list);
	return list;
}

function sortRecursivelyPetsList(list) {
	const length = list.length;
	for (let i = 0; i < length / 6; i++) {
		const stepList = list.slice(i * 6, i * 6 + 6);
		for (let j = 0; j < 6; j++) {
			const duplicatedItem = stepList.find((item, ind) => {
				return item.name === stepList[j].name && ind !== j;
			});
			if (duplicatedItem !== undefined) {
				const ind = i * 6 + j;
				const which8OfList = Math.trunc(ind / 8);
				list.splice(which8OfList * 8, 0, list.splice(ind, 1)[0]);
				sortRecursivelyPetsList(list);
			}
		}
	}
	return list;
}

let currentPage = 0;
let petsContainerHeight;

function calculatePetsContainerHeight() {
	if (document.body.clientWidth > 1400) {
		petsContainerHeight = 892;
	} else if (
		document.body.clientWidth > 999 &&
		document.body.clientWidth < 1401
	) {
		petsContainerHeight = 890;
	} else if (
		document.body.clientWidth > 625 &&
		document.body.clientWidth < 1000
	) {
		petsContainerHeight = 844;
	}
}

prevPetsPage.addEventListener('click', () => {
	currentPage--;
	calculatePetsContainerHeight();
	petsContainer.style.top = `calc(0px - ${
		petsContainerHeight * Math.abs(currentPage)
	}px)`;
	createPets();
});

nextPetsPage.addEventListener('click', () => {
	currentPage++;
	calculatePetsContainerHeight();
	petsContainer.style.top = `calc(0px - ${
		petsContainerHeight * Math.abs(currentPage)
	}px)`;
	createPets();
});

function rangeValue() {
	let newValue = testimonialsRange.value;
	const target = document.querySelector('.testimonials__slider-inner');
	if (document.body.clientWidth > 1400) {
		target.style.left = `calc(0px - ${298 * Math.abs(newValue - 1)}px)`;
		target.style.transition = `0.3s`;
	} else if (
		document.body.clientWidth > 999 &&
		document.body.clientWidth < 1401
	) {
		target.style.left = `calc(0px - ${319 * Math.abs(newValue)}px)`;
		target.style.transition = `0.3s`;
	}
}

testimonialsRange.addEventListener('input', rangeValue);

function createTestimonialsCards(list) {
	testimonialsContainer.innerHTML += createTestimonials(list);
}

function createTestimonials(list) {
	let str = '';
	for (let i = 0; i < list.length; i++) {
		str += `<div class="slider__card" data-id="${list[i].id}">
	          	<div class="slider__card-inner">
	          		<img class="slider__card-image" src="${list[i].icon}" alt="user-icon">
	          		<div class="slider__card-info">
	          			<h5 class="slider__card-title">
	          			${list[i].name}
	          			</h5>
	          			<p class="slider__card-location">
	          				${list[i].location} • ${list[i].wasOnline}
	          			</p>
	          		</div>
	          	</div>
	          	<p class="slider__card-review">${list[i].feedback}</p>
	          </div>`;
	}
	return str;
}

createTestimonialsCards(testimonialsArray);

const testimonialsCards = document.querySelectorAll('.slider__card');
const testimonialsCardsArray = Array.from(testimonialsCards);
const popup = document.querySelector('.popup');
const closeBtn = document.querySelector('.popup__button');
const testimonialInfoContainer = document.querySelector('.popup__wrapper');

function createPopup(id) {
	const testimonialInfo = `
    <div class="slider__card-inner">
    	<img class="slider__card-image" src="${
				testimonialsArray[id - 1].icon
			}" alt="user-icon">
    	<div class="slider__card-info">
    		<h5 class="slider__card-title">
    		${testimonialsArray[id - 1].name}
    		</h5>
    		<p class="slider__card-location">
    			${testimonialsArray[id - 1].location} • ${
		testimonialsArray[id - 1].wasOnline
	}
    		</p>
    	</div>
    </div>
    <p class="slider__card-review">${testimonialsArray[id - 1].feedback}</p>
  `;
	testimonialInfoContainer.innerHTML = testimonialInfo;
}

testimonialsCardsArray.forEach((elem) =>
	elem.addEventListener('click', (event) => {
		let testimonialId =
			event.target.parentNode.dataset.id || event.target.dataset.id;
		popup.classList.add('popup__show');
		document.body.style.overflowY = 'hidden';
		document.body.prepend(overlay);
		createPopup(testimonialId);
	})
);

closeBtn.addEventListener('click', closePopup);
overlay.addEventListener('click', closePopup);

function closePopup() {
	popup.classList.remove('popup__show');
	overlay.remove();
	document.body.style.overflowY = 'scroll';
}
